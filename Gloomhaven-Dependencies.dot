digraph
{
	// Set up the Gloomhaven font Pirata One (Needs PirataOne-Gloomhaven.ttf installed from the Creator Pack)
	graph [fontname = "Pirata One", fontsize = 24, penwidth = 5, bgcolor="#DCCDC3:#B4A096" gradientangle="270"];
	node  [fontname = "Pirata One", fontsize = 24, penwidth = 5, style="rounded,filled" gradientangle="270"];
	edge  [fontname = "Pirata One", fontsize = 24, penwidth = 5];

	nodesep = 0.75;
	ranksep = 0.25;

	subgraph cluster_main
	{
		label = "Gloomhaven Scenarios";
		pencolor = transparent;

		// Prosperity nodes
		{
			// Gold border
			node [color="#FFC500" fillcolor="#111111:#777777" fontcolor="#BBBBBB"];
			p1 [label = "☑️  Prosperity 1"];
			p2 [label = "☑️  Prosperity 2"];
			p3 [label = "☑️  Prosperity 3"];
			p4 [label = "☑️  Prosperity 4"];
			p5 [label = "☑️  #Prosperity 5"];
			retire_sw [label = "☑️  Spellweaver Retired"];
			retire_mt [label = "☑️  Mindthief Retired"];
			node [fillcolor="gray" fontcolor="black"];
			p6 [label = "🔲 #Prosperity 6"];
			p7 [label = "🔲 #Prosperity 7"];
			p8 [label = "🔲 #Prosperity 8"];
			p9 [label = "🔲 #Prosperity 9"];
		}

		// Scenario nodes
		{
			node [fillcolor="#111111:#777777" color="#333333" fontcolor="#BBBBBB"];
			 1 [label = "☑️  #1: Black Barrow"];
			 2 [label = "☑️  #2: Barrow Lair"];
			 3 [label = "☑️  #3: Inox Encampment"];
			 4 [label = "☑️  #4: Crypt of the Damned"];
			 5 [label = "☑️  #5: Ruinous Crypt"];
			 6 [label = "☑️  #6: Decaying Crypt"];
			 7 [label = "☑️  #7: Vibrant Grotto"];
			 8 [label = "☑️  #8: Gloomhaven Warehouse 🌇"];
			10 [label = "☑️  #10: Plane of Elemental Power"];
			13 [label = "☑️  #13: Temple of the Seer"];
			14 [label = "☑️  #14: Frozen Hollow"];
			17 [label = "☑️  #17: Lost Island"];
			18 [label = "☑️  #18: Abandoned Sewers 🌇"];
			19 [label = "☑️  #19: Forgotten Crypt"];
			20 [label = "☑️  #20: Necromancer's Sanctum"];
			21 [label = "☑️  #21: Infernal Throne 🌇"];
			23 [label = "☑️  #23: Deep Ruins 🌇"];
			27 [label = "☑️  #27: Ruinous Rift"];
			28 [label = "☑️  #28: Outer Ritual Chamber"];
			29 [label = "☑️  #29: Sanctuary of Gloom"];
			52 [label = "☑️  #52: Noxious Cellar 🌇"];
			53 [label = "☑️  #53: Crypt Basement"];
			54 [label = "☑️  #54: Palace of Ice"];
			61 [label = "☑️  #61: Fading Lighthouse"];
			62 [label = "☑️  #62: Pit of Souls"];
			65 [label = "☑️  #65: Sulfer Mine"];
			70 [label = "☑️  #70: Chained Isle 🌇"];
			79 [label = "☑️  #79: Lost Temple"];
			93 [label = "☑️  #93: Sunken Vessel 🌇"];
		}

		{
			node [fillcolor="gray"];
			16 [label = "🔲 #16: Mountain Pass"];
			22 [label = "🔲 #22: Temple of the Elements 🌇"];
			26 [label = "🔲 #26: Ancient Cistern"];
			43 [label = "🔲 #43: Drake Nest"];
			61 [label = "🔲 #61: Fading Lighthouse"];
			69 [label = "🔲 #69: Well of the Unfortunate"];
			72 [label = "🔲 #72: Oozing Grove"];
			81 [label = "🔲 #81: Temple of the Eclipse"];
			87 [label = "🔲 #87: Corrupted Cove 🌇"];
			90 [label = "🔲 #90: Demonic Rift"];
			94 [label = "🔲 #94: Vermling Nest"];
		}

		{
			node [fillcolor="#550000:#AA3939" color="#801515" fontcolor="#D46A6A"];
			9 [label = "🔒 #9: Diamond Mine"];
		}

		{
			node [fillcolor="gray" color="#801515"];
			15 [label = "🔒 #15: Shrine of Strength"];
			24 [label = "🔒 #24"];
			31 [label = "🔒 #31"];
			43 [label = "🔒 #43"];
		}

		{
			// Achievement Nodes
			// Gold border
			node [shape = invhouse, color="#FFC500"];

			{
				node [fillcolor="#111111:#777777" fontcolor="#BBBBBB"];
				// Party achievement nodes
				party_first_steps           [label = "☑️  Party: First Steps"];
				party_jekserahs_plans       [label = "☑️  Party: Jekserah’s Plans"];
				party_dark_bounty           [label = "☑️  Party: Dark Bounty"];
				party_stonebreakers_censer  [label = "☑️  Party: Stonebreaker's Censer"];
				party_map_to_treasure       [label = "☑️  Party: A Map to Treasure"];
				party_demons_errand         [label = "☑️  Party: A Demon's Errand"];
				party_an_invitation         [label = "☑️  Party: An Invitation"];
				party_fish_aid              [label = "☑️  Party: Fish's Aid"];
				party_poisons_source        [label = "☑️  Party: The Poison's Source"];
				party_through_ruins         [label = "☑️  Party: Through the Ruins"];
				node [fillcolor="gray" fontcolor="black"];
				party_following_clues       [label = "🔲 Party: Following Clues"];
			}

			// Global achievement nodes
			{
				node [fillcolor="#004400:#2D882D" fontcolor="#88CC88"];
				global_merchant_flees       [label = "✅ Global: The Merchant Flees"];
				global_power_of_enhancement [label = "✅ Global: The Power of Enhancement"];
				global_rift_neutralized     [label = "✅ Global: The Rift Neutralized"];
			}
			{
				node [fillcolor="#550000:#AA3939" fontcolor="#D46A6A"];
				global_dead_inside          [label = "❌ Global: The Dead Invade"];
				global_artifact_lost        [label = "❌ Global: Artifact Lost"];
				global_edge_of_darkness     [label = "❌ Global: Edge of Darkness"];
				global_water_breathing     [label = "❌ Global: Water Breathing"];
			}

			{
				node [fillcolor="#111111:#777777" fontcolor="#BBBBBB"];
				quest_seeker_of_xorn        [label = "🖋️ “Seeker of Xorn” personal quest"];
				quest_fall_of_man           [label = "🖋️ “Fall of Man” personal quest"];
			}
		}

		{rank = source 1}
		// {rank = max 54 65 70 93}

		// Scenario unlocks
		                                1 -> {/* 2, */ party_first_steps};
		party_first_steps           ->  2 -> {3, 4};
		                                3 -> {8, 9, party_jekserahs_plans};
		                                4 -> {5, 6};
		                                5 -> {/* 10, */ 14, 19};
		                                6 -> {8, party_jekserahs_plans, party_dark_bounty};
		                                7 -> {20};
		party_jekserahs_plans       ->  8 -> {7, 13, 14};
		                               10 -> {21, 22, party_demons_errand};
									   18 -> {14, 23, 26, 43};
		                               19 -> {27, party_stonebreakers_censer};
		                               20 -> {16, 18, 28};
		{party_demons_errand, party_following_clues} -> 22 [label = "Either party achievement"];
		                               23 -> {party_through_ruins}
		{party_through_ruins, global_water_breathing} -> 26 [label = "Either/Or"];
		party_stonebreakers_censer  -> 27;
		party_dark_bounty           -> 28 -> {/* 29, */ party_an_invitation};
		                               29 -> global_edge_of_darkness;
		quest_seeker_of_xorn        -> 52 -> {53};
		                               53 -> {54};
		quest_fall_of_man           -> 61 -> {62};
		p4                          -> 72;
		party_first_steps           -> 79;
		{retire_mt, party_poisons_source} -> 87;
		retire_sw                   -> 90;
		party_map_to_treasure       -> 93;

		p1 -> p2 -> p3 -> p4 -> p5 -> p6 -> p7 -> p8 -> p9;

		subgraph OptionsChosen
		{
			edge [color = "#2D882D"   label = "chosen"];

		                               13 -> {17};
		}

		subgraph OptionsNotChosen
		{
			edge [color = "#D46A6A"   label = "not chosen" style = dashed, penwidth = 2];

		                               13 -> {15, 20};
		}

		// Global achievement requirements
		subgraph GlobalAchievements
		{
			// Incomplete at the time
			subgraph IncompleteGlobalAchievements
			{
				edge [color = "#D46A6A"   label = "❌" style = dashed, penwidth = 2];

				global_merchant_flees       ->  3;
				global_dead_inside          ->  8;
				global_rift_neutralized     -> {10, 21};
				global_artifact_lost        -> 27;
			}

			subgraph BlockedGlobalAchievementUnlocks
			{
				edge [color = "red"   label = "❌", penwidth = 8];

				global_merchant_flees       ->  9;
			}

			subgraph BlockedGlobalAchievementRequirements
			{
				edge [label = "🔒" style = dashed];

				9                           -> global_dead_inside;
			}

			subgraph CompleteGlobalAchievements
			{
				edge [color = "#2D882D" label = "✅"];

				 8 -> global_merchant_flees       -> {7, 20};
				14 -> global_power_of_enhancement -> {7, 19, 31, 43};
				21 -> {global_rift_neutralized};
				27 -> {global_rift_neutralized};
			}
		}

		// Scenario links (physical connections)
		subgraph ScenarioLinks
		{
			edge [dir = none, color = "gray20:gray66:gray20", penwidth = 2];

			1 ->  2;
			5 -> 10;
			16 -> 24;
			28 -> 29;
		}
	}

	subgraph cluster_legend
	{
		label = "Legend";
		pencolor = black;

		linked     [label = "Linked to Gloomhaven 🌇"];

		subgraph cluster_basic
		{
			pencolor = transparent;
			label = "";
			incomplete [fillcolor="gray" label = "🔲 Incomplete"];
			completed  [fillcolor="#111111:#777777" color="#333333" fontcolor="#BBBBBB" label = "☑️  Completed"];
			blocked    [fillcolor="#550000:#AA3939" color="#801515" fontcolor="#D46A6A" label = "🔒 Blocked"];
			locked     [fillcolor="gray" color="#801515" label = "🔒 Locked"];
		}

		subgraph cluster_achievement
		{
			pencolor = transparent;
			label = "";
			node [shape = invhouse, color="#FFC500"];
			party_achievement [label = "☑️  Party Achievement", fillcolor="#111111:#777777" fontcolor="#BBBBBB"];
			global_complete   [label = "✅ Global: Complete" fillcolor="#004400:#2D882D" fontcolor="#88CC88"];
			global_incomplete [label = "❌ Global: Incomplete" fillcolor="#550000:#AA3939" fontcolor="#D46A6A"];
		}

		completed -> party_achievement [style = invis];

		linked1     [label = "Linked 1"];
		linked2     [label = "Linked 2"];
		linked1 -> linked2 [dir = none, color = "gray20:gray66:gray20", penwidth = 2];
	}

	// {21, 22, 24, 29} -> completed [style = invis, weight = 0.1];
	{22} -> completed [style = invis, weight = 0.1];
}

